<view class="bottom-dialog-body">
  <scroll-view class="bottom-dialog-scroll" scroll-y="true" enhanced="{{true}}" show-scrollbar="{{false}}">
    <view class="action-bar">
      <button class="action-btn secondary" bindtap="onSaveImageTap">保存为图片</button>
      <button class="action-btn primary" open-type="share">发送报价单</button>
    </view>
    <!-- 配置项:主题选择 -->
    <view class="config-schema-section">
      <view class="config-schema-header" bindtap="onToggleSection" data-section="theme">
        <service-collapse-icon collapsed="{{CollapseStatus.theme}}" />
        <view class="config-schema-title">主题选择</view>
      </view>
      <view wx:if="{{!CollapseStatus.theme}}">
        <view class="theme-options">
          <view class="theme-option {{quoteDetail.theme === 'amber' ? 'active' : ''}}" data-theme="amber" bindtap="onThemeTap">
            <image class="theme-bg" src="../../assets/button_1.png" mode="aspectFill"></image>
            <view class="theme-overlay"></view>
            <text class="theme-name">月光</text>
          </view>
          <view class="theme-option {{quoteDetail.theme === 'neon' ? 'active' : ''}}" data-theme="neon" bindtap="onThemeTap">
            <image class="theme-bg" src="../../assets/button_2.png" mode="aspectFill"></image>
            <view class="theme-overlay"></view>
            <text class="theme-name">深海</text>
          </view>
          <view class="theme-option {{quoteDetail.theme === 'moonlight' ? 'active' : ''}}" data-theme="moonlight" bindtap="onThemeTap">
            <image class="theme-bg" src="../../assets/button_3.png" mode="aspectFill"></image>
            <view class="theme-overlay"></view>
            <text class="theme-name">琥珀</text>
          </view>
          <view class="theme-option {{quoteDetail.theme === 'deep-sea' ? 'active' : ''}}" data-theme="deep-sea" bindtap="onThemeTap">
            <image class="theme-bg" src="../../assets/button_4.png" mode="aspectFill"></image>
            <view class="theme-overlay"></view>
            <text class="theme-name">霓虹</text>
          </view>
        </view>
      </view>
    </view>
    <!-- 配置项:我的公司信息 -->
    <view class="config-schema-section">
      <view class="config-schema-header" bindtap="onToggleSection" data-section="company">
        <service-collapse-icon collapsed="{{CollapseStatus.company}}" />
        <view class="config-schema-title">我的公司信息</view>
      </view>
      <view wx:if="{{!CollapseStatus.company}}">
        <view class="config-schema-group">
          <input class="config-schema-pill" placeholder="我的公司名称(可选)" value="{{quoteDetail.domain.name}}" bindinput="onDomainNameInput" bindblur="onDomainNameBlur" />
          <view class="config-schema-pill">我的公司LOGO(可选)</view>
        </view>
      </view>
    </view>
    <!-- 配置项:服务内容 -->
    <view class="config-schema-section">
      <view class="config-schema-header" bindtap="onToggleSection" data-section="service">
        <service-collapse-icon collapsed="{{CollapseStatus.service}}" />
        <view class="config-schema-title">服务内容</view>
      </view>
      <view wx:if="{{!CollapseStatus.service}}">
        <view class="config-schema-group">
          <view wx:for="{{quoteDetail.pricingItems}}" wx:for-item="category" wx:for-index="categoryIndex" wx:key="name">
            <view class="config-schema-label">{{category.name}}</view>
            <view class="config-schema-row">
              <view class="service-list-box service-list-box-{{categoryIndex}}">
                <view wx:if="{{showDragServiceOverlay && dragServiceCategoryIndex === categoryIndex}}" class="config-schema-pill service-drag-ghost" style="top: {{dragServiceOverlayTop}}px">
                  <view class="service-header flex">
                    <view class="service-summary">
                      <view class="service-title">{{dragServiceSnapshot.name}}</view>
                      <view class="service-meta">
                        <text>¥{{dragServiceSnapshot.unitPrice}}/{{dragServiceSnapshot.unit}}</text>
                        <text>x{{dragServiceSnapshot.quantity}}</text>
                        <text class="service-meta-separator">·</text>
                        <text>{{dragServiceSnapshot.deliveryPeriodDays}}天</text>
                      </view>
                    </view>
                  </view>
                </view>
                <!-- 服务项目 -->
                <service-item-card wx:for="{{category.items}}" wx:for-item="service" wx:for-index="serviceIndex" wx:key="name" service="{{service}}" collapsed="{{serviceCollapseStatus[categoryIndex] && serviceCollapseStatus[categoryIndex][serviceIndex]}}" category-index="{{categoryIndex}}" service-index="{{serviceIndex}}" bind:delete="onDeleteService" bind:toggleCollapse="onToggleServiceCollapse" bind:serviceChange="onServiceChange" bind:fieldBlur="onServiceFieldBlur" bind:dragStart="onServiceDragStart" bind:dragMove="onServiceDragMove" bind:dragEnd="onServiceDragEnd" />
              </view>
              <view class="config-schema-pill config-schema-action">＋ 添加服务项</view>
            </view>
          </view>
        </view>
        <view class="config-schema-footer">＋ 增加服务类别</view>
      </view>
    </view>
    <!-- 配置项:付款比例设置 -->
    <view class="config-schema-section">
      <view class="config-schema-header" bindtap="onToggleSection" data-section="payment">
        <service-collapse-icon collapsed="{{CollapseStatus.payment}}" />
        <view class="config-schema-title">付款比例设置</view>
      </view>
      <view wx:if="{{!CollapseStatus.payment}}">
        <view class="config-schema-group">
          <input class="config-schema-pill" type="digit" placeholder="定金比例(%)" value="{{quoteDetail.serviceProcess.depositRatio * 100}}" bindinput="onDepositRatioInput" bindblur="onDepositRatioBlur" />
          <input class="config-schema-pill" type="digit" placeholder="尾款比例(%)" value="{{quoteDetail.serviceProcess.finalPaymentRatio * 100}}" bindinput="onFinalPaymentRatioInput" bindblur="onFinalPaymentRatioBlur" />
          <view class="config-schema-pill config-schema-action">增加交付节点</view>
        </view>
      </view>
    </view>
    <!-- 底部备注信息 -->
    <view class="config-schema-section">
      <view class="config-schema-header" bindtap="onToggleSection" data-section="remark">
        <service-collapse-icon collapsed="{{CollapseStatus.remark}}" />
        <view class="config-schema-title">备注</view>
      </view>
      <view wx:if="{{!CollapseStatus.remark}}">
        <view class="config-schema-group">
          <textarea class="config-textarea" placeholder="输入备注信息" value="{{quoteDetail.serviceTerms}}" bindinput="onServiceTermsInput" bindblur="onServiceTermsBlur" />
        </view>
      </view>
    </view>
    <view style="height: 10vh;"></view>
  </scroll-view>
</view>