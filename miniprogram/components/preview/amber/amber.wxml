<view class="page">
  <view class="quote-container">
    <view class="quote-header">
      <view class="header-left">
        <view class="quote-meta">
          <text class="quote-title">报价单</text>
          <view wx:if="{{quoteDetail.projectName}}" class="quote-subtitle">
            <text>{{quoteDetail.projectName}}</text>
          </view>
        </view>
      </view>
      <view wx:if="{{quoteDetail.clientName}}" class="header-right">
        <text class="client-label">致</text>
        <text class="client-name">{{quoteDetail.clientName}}</text>
      </view>
    </view>
    <!-- 报价项目 -->
    <view class="quote-section" wx:for="{{quoteDetail.pricingItems}}" wx:for-item="category" wx:key="name">
      <view class="section-title">{{category.name}}</view>
      <view class="section-table">
        <view class="table-row table-header">
          <text class="col-name">项目</text>
          <text class="col-unit-price">单价</text>
          <text class="col-quantity">数量</text>
          <text class="col-delivery">周期</text>
        </view>
        <view class="table-row" wx:for="{{category.items}}" wx:for-item="service" wx:key="name">
          <text class="col-name">{{service.name}}</text>
          <text class="col-unit-price">{{service.unitPrice}} 元/{{service.unit}}</text>
          <text class="col-quantity">{{service.quantity}}</text>
          <text wx:if="{{ service.deliveryPeriodDays <= 0 }}" class="col-delivery">待定</text>
          <text wx:else class="col-delivery">{{ service.deliveryPeriodDays }} 天</text>
        </view>
      </view>
      <view class="section-footer">
        <view class="section-row">
          <text class="footer-text">合计金额：{{category.computeData.amount || 0}} 元</text>
        </view>
      </view>
    </view>
    <!-- 支付节点 -->
    <view class="quote-section">
      <view class="section-title">支付节点</view>
      <view class="section-table">
        <view class="table-row table-header">
          <text class="col-name">节点</text>
          <text class="col-quantity">占比</text>
          <text class="col-delivery">时间</text>
        </view>
        <view class="table-row" wx:for="{{quoteDetail.PayNodes}}" wx:for-item="node" wx:for-index="index" wx:key="nodeName">
          <text class="col-name">{{index + 1}}. {{node.nodeName}}</text>
          <text class="col-quantity">{{node.nodeRatio * 100}}%</text>
          <text wx:if="{{node.nodeDate}}" class="col-delivery">{{node.nodeDate}}</text>
          <text wx:else class="col-delivery">待定</text>
        </view>
      </view>
      <view class="section-footer">
        <view class="section-row">
          <text class="footer-text">
            整体预计工期：{{quoteDetail.computeData.overallDeliveryPeriodDays}} 天
          </text>
        </view>
      </view>
    </view>
    <view class="quote-section" wx:if="{{quoteDetail.serviceTerms}}">
      <view class="section-title">备注</view>
      <view class="section-body">
        <text class="section-text">{{quoteDetail.serviceTerms}}</text>
      </view>
    </view>
  </view>
  <view wx:if="{{parentViewMode === 'preview'}}" style="height:20vh"></view>
</view>