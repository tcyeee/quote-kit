<view class="page">
  <view class="quote-container">
    <view class="quote-header">
      <view class="header-left">
        <text class="header-title">报价明细</text>
        <view class="header-subtitle-row">
          <text class="header-subtitle-en">PREMIUM QUOTATION</text>
          <view class="header-subtitle-line"></view>
        </view>
      </view>
      <view wx:if="{{quoteDetail.projectName}}" class="header-right">
        <text class="project-label">项目</text>
        <text class="project-name">{{quoteDetail.projectName}}</text>
      </view>
    </view>
    <view class="divider-main"></view>
    <view class="category-section" wx:for="{{quoteDetail.pricingItems}}" wx:for-item="category" wx:key="name">
      <view class="category-header">
        <view class="category-header-left">
          <view class="category-indicator"></view>
          <view class="category-title-group">
            <text class="category-title">{{category.name}}</text>
          </view>
        </view>
        <view wx:if="{{category.computeData && category.computeData.amount != null}}" class="category-subtotal">
          <text class="subtotal-label">SUBTOTAL</text>
          <text class="subtotal-value">¥{{category.computeData.amount}}</text>
        </view>
      </view>
      <view class="category-card">
        <view class="service-row" wx:for="{{category.items}}" wx:for-item="service" wx:key="name">
          <view class="service-main">
            <text class="service-title">{{service.name}}</text>
            <view class="service-meta">
              <text class="service-meta-text">{{service.quantity}}{{service.unit}}</text>
              <text class="service-meta-dot">·</text>
              <text wx:if="{{service.deliveryPeriodDays <= 0}}" class="service-meta-text">
                周期待定
              </text>
              <text wx:else class="service-meta-text">{{service.deliveryPeriodDays}} 天</text>
            </view>
          </view>
          <view class="service-price">
            <text class="service-price-label">单价</text>
            <text class="service-price-value">¥{{service.unitPrice}}</text>
          </view>
        </view>
      </view>
    </view>
    <view wx:if="{{quoteDetail.serviceTerms}}" class="remark-section">
      <view class="section-header">
        <text class="section-title">备注说明</text>
      </view>
      <view class="remark-card">
        <text class="remark-text">{{quoteDetail.serviceTerms}}</text>
      </view>
    </view>
    <view wx:if="{{totalAmount}}" class="summary-section">
      <view class="summary-card">
        <view class="summary-row">
          <text class="summary-label">项目分项小计</text>
          <text class="summary-value">¥{{totalAmountDisplay}}</text>
        </view>
        <view wx:if="{{discountAmount > 0}}" class="summary-row">
          <text class="summary-label">优惠减免</text>
          <text class="summary-discount">-¥{{discountAmountDisplay}}</text>
        </view>
        <view class="summary-divider"></view>
        <view class="summary-total-row">
          <view class="summary-total-text">
            <text class="summary-total-en">TOTAL AMOUNT</text>
            <text class="summary-total-cn">最终总计</text>
          </view>
          <text class="summary-total-amount">¥{{finalTotalAmountDisplay}}</text>
        </view>
      </view>
    </view>
  </view>
  <view wx:if="{{parentViewMode === 'preview'}}" style="height:20vh"></view>
</view>