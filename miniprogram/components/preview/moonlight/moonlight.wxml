<view class="page">
  <view class="card-header">
    <view class="header-accent"></view>
    <view class="header-title"></view>
  </view>
  <view class="quote-card">
    <view class="card-meta">
      <view wx:if="{{quoteDetail.projectName}}" class="meta-row">
        <text class="meta-icon">ğŸ·ï¸</text>
        <text class="meta-text">{{quoteDetail.projectName}}</text>
      </view>
    </view>
    <view class="section-block">
      <view class="section-header-row">
        <text class="col-project">é¡¹ç›® PROJECT</text>
        <text class="col-price">ä»·æ ¼ PRICE</text>
        <text class="col-time">å‘¨æœŸ TIME</text>
      </view>
      <block wx:for="{{quoteDetail.pricingItems}}" wx:for-item="category" wx:key="name">
        <block wx:for="{{category.items}}" wx:for-item="service" wx:key="name">
          <view class="section-item-row">
            <text class="col-project">{{service.name}}</text>
            <text class="col-price">Â¥{{service.unitPrice * service.quantity}}</text>
            <text wx:if="{{service.deliveryPeriodDays <= 0}}" class="col-time">å¾…å®š</text>
            <text wx:else class="col-time">{{service.deliveryPeriodDays}} å¤©</text>
          </view>
        </block>
      </block>
    </view>
    <view wx:if="{{payNodes.length}}" class="section-block">
      <view class="section-title-row">
        <view class="section-title-main">
          <text class="section-title-label">ä»˜æ¬¾è®¡åˆ’</text>
          <text class="section-title-en">PAYMENT PLAN</text>
        </view>
      </view>
      <view class="section-payment-rows">
        <view class="payment-row" wx:for="{{payNodes}}" wx:for-item="node" wx:key="nodeName">
          <text class="payment-name">{{node.nodeName}}ï¼ˆ{{node.nodeRatio * 100}}%ï¼‰</text>
          <text class="payment-amount">Â¥{{node.amount}}</text>
        </view>
      </view>
    </view>
    <view wx:if="{{quoteDetail.serviceTerms}}" class="section-block">
      <view class="section-title-row">
        <view class="section-title-main">
          <text class="section-title-label">å¤‡æ³¨</text>
          <text class="section-title-en">REMARKS</text>
        </view>
      </view>
      <view class="remarks-body">
        <text class="remarks-text">{{quoteDetail.serviceTerms}}</text>
      </view>
    </view>
    <view wx:if="{{totalAmount}}" class="summary-card">
      <block wx:if="{{discountAmount > 0}}">
        <view class="summary-row">
          <text class="summary-label">é¡¹ç›®å°è®¡</text>
          <text class="summary-value">Â¥{{totalAmountDisplay}}</text>
        </view>
        <view class="summary-row">
          <text class="summary-label">ä¼˜æƒ </text>
          <text class="summary-discount">-Â¥{{discountAmountDisplay}}</text>
        </view>
        <view class="summary-divider"></view>
      </block>
      <view class="summary-row summary-total-row">
        <text class="summary-total-label">æœ€ç»ˆæ€»è®¡</text>
        <text class="summary-total-value">Â¥{{finalTotalAmountDisplay}}</text>
      </view>
    </view>
  </view>
  <view wx:if="{{parentViewMode === 'preview'}}" style="height:30vh"></view>
</view>