<view>
  <view class="pay-node-list-box">
    <view wx:if="{{showDragPayNodeOverlay}}" class="config-schema-pill pay-node-drag-ghost" style="top: {{dragPayNodeOverlayTop}}px">
      <view class="pay-node-header flex">
        <view class="pay-node-summary">
          <view class="pay-node-item-content">
            <view class="pay-node-title">{{dragPayNodeSnapshot.nodeName}}</view>
          </view>
          <view class="pay-node-meta">
            <text>{{dragPayNodeSnapshot.nodeRatio * 100}}%</text>
            <text class="pay-node-meta-separator">·</text>
            <text wx:if="{{dragPayNodeSnapshot.nodeDate}}">{{dragPayNodeSnapshot.nodeDate}}</text>
            <text wx:else>时间待定</text>
          </view>
        </view>
      </view>
    </view>
    <view class="config-schema-group" wx:for="{{payNodes}}" wx:for-item="node" wx:for-index="index" wx:key="index">
      <span class="icon--move-y-circle icon-size-15" style="color:gray;width:15px" catchtouchstart="onPayNodeDragStart" catchtouchmove="onPayNodeDragMove" catchtouchend="onPayNodeDragEnd" data-index="{{index}}"></span>
      <view class="config-schema-pill">
        <view class="pay-node-header flex" bindtap="onToggleCollapseTap" data-index="{{index}}">
          <view class="pay-node-summary">
            <view class="pay-node-title">{{node.nodeName}}</view>
            <text class="pay-node-meta-separator">·</text>
            <text>{{node.nodeRatio * 100}}%</text>
            <text class="pay-node-meta-separator">·</text>
            <text wx:if="{{node.nodeDate}}">{{node.nodeDate}}</text>
            <text wx:else>时间待定</text>
          </view>
          <span class="icon--delete-16-regular icon-size-15 icon-color-error" catchtap="onDeleteNodeTap" data-index="{{index}}"></span>
        </view>
        <view class="pay-node-body {{payNodeCollapseStatus[index] ? 'pay-node-body--collapsed' : 'pay-node-body--expanded'}}">
          <view class="pay-node-field-grid">
            <view class="pay-node-field-item pay-node-field-item--name">
              <view class="pay-node-field-label">节点名称</view>
              <input class="config-input-small" placeholder="节点名称" value="{{node.nodeName}}" data-index="{{index}}" bindblur="onNodeNameBlur" />
            </view>
            <view class="pay-node-field-item pay-node-field-item--ratio">
              <view class="pay-node-field-label">比例(%)</view>
              <input class="config-input-small pay-node-ratio-input" type="digit" placeholder="比例(%)" value="{{node.nodeRatio * 100}}" data-index="{{index}}" bindinput="onRatioInput" bindblur="onBlur" />
            </view>
            <view class="pay-node-field-item pay-node-field-item--date">
              <view class="pay-node-field-label">日期(可选)</view>
              <view class="pay-node-time">
                <picker class="pay-node-time-picker" mode="date" value="{{node.nodeDate}}" data-index="{{index}}" bindchange="onNodeDateChange">
                  <view class="config-input-small pay-node-time-display">
                    {{node.nodeDate || '选择'}}
                  </view>
                </picker>
              </view>
            </view>
          </view>
        </view>
      </view>
    </view>
  </view>
  <view class="config-schema-action" bindtap="onAddNode">＋ 增加交付节点</view>
</view>